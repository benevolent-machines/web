<!DOCTYPE html>
<html>
<head>
    <title>Excel Redirect Helper</title>
    <script>
        // Function to parse the query string and return parameters as an object
        function getQueryStringParameters() {
            var params = {};
            var queryString = window.location.search.substring(1);
            var vars = queryString.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                // Use decodeURIComponent to handle URLs with special characters
                params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
            }
            return params;
        }

        // Function to construct the destination URL and redirect
        function redirectToDestination() {
            var params = getQueryStringParameters();
            var destinationPage = params.page;
            delete params.page; // Remove the page parameter from the object

            // Reconstruct the query string with remaining parameters
            var additionalParams = Object.keys(params).map(function(key) {
                return key + "=" + params[key];
            }).join("&");

            // Check if the destination URL already contains a query string
            var finalUrl = destinationPage + (destinationPage.includes('?') ? "&" : "?") + additionalParams;
            window.location = finalUrl; // Redirect to the final URL
        }

        // Call the redirect function when the page loads
        window.onload = redirectToDestination;
    </script>
</head>
<body>
    <p>Redirecting...</p>
</body>
</html>
